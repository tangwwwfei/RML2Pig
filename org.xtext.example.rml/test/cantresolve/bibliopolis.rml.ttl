######################################################################################
# 1. Prefixes
######################################################################################

@prefix rr:       <http://www.w3.org/ns/r2rml#>.
@prefix rml:      <http://semweb.mmlab.be/ns/rml#>.
@prefix ex:       <http://example.com/ns#>.
@prefix ql:       <http://semweb.mmlab.be/ns/ql#>.
@prefix xsd:      <http://www.w3.org/2001/XMLSchema#>.
@prefix rdfs:     <http://www.w3.org/2000/01/rdf-schema#>.
@prefix dcterms:  <http://purl.org/dc/terms/> .
@prefix adms:     <http://www.w3.org/ns/adms#> .


######################################################################################
# 2. Mapping Document Metadata
######################################################################################

[]  dcterms:title "KB Mappings - bibliopolis";
    dcterms:description "Describes an RML mapping from the bibliopolis.xml input source to RDF " ;
    dcterms:creator <http://rml.io/people/AnastasiaDimou> ;
    dcterms:created "2016-03-18"^^xsd:date;
    dcterms:modified "2016-03-21"^^xsd:date .



######################################################################################
# 3. Input Sources
######################################################################################

<#Admin_LogicalSource>
  rml:source "Input/Sample/bibliopolis_sample.xml" ;
  rml:iterator "/data/metadata/admin" ;
  rml:referenceFormulation ql:XPath .


<#Bibliopolis_LogicalSource>
  rml:source "Input/Sample/bibliopolis_sample.xml" ;
  rml:iterator "/data/metadata" ;
  rml:referenceFormulation ql:XPath .



######################################################################################
# 4. Mapping Definitions
######################################################################################

<#AdminMapping>
  rml:logicalSource <#Admin_LogicalSource> ;

  rr:subjectMap [ 
    rr:template "http://data.kb.nl/bibliopolis/admin/{nameIndicator}" ;
    rr:class ex:Admin ];

  rr:predicateObjectMap [
    rr:predicate rdfs:label;
    rr:objectMap [
      rml:reference "sortName";
      rr:language "nl" ] ].

<#RecordMapping>
  rml:logicalSource <#Bibliopolis_LogicalSource> ;

  rr:subjectMap [ 
    rr:template "http://data.kb.nl/bibliopolis/record/{srw_dc:dc/dc:identifier}" ;
    rr:class ex:Record ];

  rr:predicateObjectMap [
    rr:predicate dcterms:identifier;
    rr:objectMap [
      rml:reference "srw_dc:dc/dc:identifier" ] ];

  rr:predicateObjectMap [
    rr:predicate dcterms:isPartOf;
    rr:objectMap [
      rr:parentTriplesMap <#CollectionMapping> ] ].


<#CollectionMapping>
  rml:logicalSource <#Bibliopolis_LogicalSource> ;

  rr:subjectMap [ 
    rr:template "http://data.kb.nl/bibliopolis/collection/{index/collection}" ;
    rr:class ex:Record ];

  rr:predicateObjectMap [
    rr:predicate adms:identifier;
    rr:objectMap [
      rr:parentTriplesMap <#IdentifierMapping> ]  ].


<#IdentifierMapping>
  rml:logicalSource <#Bibliopolis_LogicalSource> ;

  rr:subjectMap [ 
    rr:template "http://data.kb.nl/bibliopolis/collection/identifier/{index/collectionIdentifier}" ;
    rr:class adms:Identifier ].